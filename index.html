<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Reto Polipuntos - Formación</title>
    
    <!-- React y ReactDOM -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    
    <!-- Babel para traducir JSX -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    
    <!-- Tailwind CSS para el diseño -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Confetti para la celebración -->
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>

    <!-- Estilos extra para animaciones -->
    <style>
        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-5px); }
            75% { transform: translateX(5px); }
        }
        .animate-shake { animation: shake 0.3s ease-in-out; }
        .animate-pulse { animation: pulse 2s cubic-bezier(0.4, 0, 0.6, 1) infinite; }
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: .5; }
        }
    </style>
</head>
<body class="bg-slate-50 text-slate-800">
    <div id="root"></div>

    <script type="text/babel">
        // --- COMPONENTES DE ICONOS (SVG) ---
        const Icons = {
            Zap: () => <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentColor" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><polygon points="13 2 3 14 12 14 11 22 21 10 12 10 13 2"/></svg>,
            Star: ({size}) => <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="currentColor" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"/></svg>,
            Trophy: ({className}) => <svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}><path d="M6 9H4.5a2.5 2.5 0 0 1 0-5H6"/><path d="M18 9h1.5a2.5 2.5 0 0 0 0-5H18"/><path d="M4 22h16"/><path d="M10 14.66V17c0 .55-.47.98-.97 1.21C7.85 18.75 7 20.24 7 22"/><path d="M14 14.66V17c0 .55.47.98.97 1.21C16.15 18.75 17 20.24 17 22"/><path d="M18 2H6v7a6 6 0 0 0 12 0V2Z"/></svg>,
            Award: ({size}) => <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><circle cx="12" cy="8" r="7"/><polyline points="8.21 13.89 7 23 12 20 17 23 15.79 13.88"/></svg>,
            Eraser: ({size}) => <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="m7 21-4.3-4.3c-1-1-1-2.5 0-3.4l9.6-9.6c1-1 2.5-1 3.4 0l5.6 5.6c1 1 1 2.5 0 3.4L13 21"/><path d="M22 21H7"/><path d="m5 11 9 9"/></svg>,
            RefreshCcw: ({size}) => <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M21 12a9 9 0 0 0-9-9 9.75 9.75 0 0 0-6.74 2.74L3 8"/><path d="M3 3v5h5"/><path d="M3 12a9 9 0 0 0 9 9 9.75 9.75 0 0 0 6.74-2.74L21 16"/><path d="M16 16h5v5"/></svg>,
            MessageSquare: ({size}) => <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"/></svg>,
            Heart: ({size}) => <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z"/></svg>,
            Target: ({size}) => <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><circle cx="12" cy="12" r="10"/><circle cx="12" cy="12" r="6"/><circle cx="12" cy="12" r="2"/></svg>
        };

        // --- CONFIGURACIÓN DEL JUEGO (EDITAR AQUÍ SI NECESITAS CAMBIAR LA FRASE) ---
        const GAME_CONFIG = {
            pointsPerWord: 5,  // CAMBIO: 5 puntos por palabra (4 palabras = 20 pts)
            bonusPoints: 10,   // CAMBIO: 10 puntos de bono (Total = 30 pts)
            sentenceStructure: [
                { text: "La", type: "text" },
                { type: "blank", correct: "pasión", placeholder: "______" },
                { text: "por lo que", type: "text" },
                { type: "blank", correct: "haces", placeholder: "_____" },
                { text: "es el", type: "text" },
                { type: "blank", correct: "motor", placeholder: "_____" },
                { text: "de tu", type: "text" },
                { type: "blank", correct: "éxito", placeholder: "_____" },
                { text: ".", type: "text" }
            ]
        };

        function App() {
            const [userAnswers, setUserAnswers] = React.useState({});
            const [gameState, setGameState] = React.useState('playing'); 
            const [score, setScore] = React.useState(0);
            const [attempts, setAttempts] = React.useState(0);

            React.useEffect(() => {
                resetGame();
            }, []);

            const resetGame = () => {
                setUserAnswers({});
                setGameState('playing');
                setScore(0);
                setAttempts(0);
            };

            const handleInputChange = (index, value) => {
                if (gameState === 'won') return;
                setGameState('playing');
                setUserAnswers(prev => ({ ...prev, [index]: value }));
            };

            const normalize = (text) => text.toLowerCase().trim();

            const checkAnswers = () => {
                const blanks = GAME_CONFIG.sentenceStructure.filter(p => p.type === 'blank');
                const totalBlanks = blanks.length;
                let correctCount = 0;

                GAME_CONFIG.sentenceStructure.forEach((part, index) => {
                    if (part.type === 'blank') {
                        const userAnswer = userAnswers[index] || "";
                        if (normalize(userAnswer) === normalize(part.correct)) {
                            correctCount++;
                        }
                    }
                });

                if (correctCount === totalBlanks) {
                    const finalScore = (totalBlanks * GAME_CONFIG.pointsPerWord) + GAME_CONFIG.bonusPoints;
                    setScore(finalScore);
                    setGameState('won');
                    triggerConfetti();
                } else {
                    setGameState('error');
                    setAttempts(prev => prev + 1);
                }
            };

            const triggerConfetti = () => {
                const duration = 3000;
                const end = Date.now() + duration;

                const frame = () => {
                    window.confetti({
                        particleCount: 2,
                        angle: 60,
                        spread: 55,
                        origin: { x: 0 },
                        colors: ['#003876', '#FDB913', '#FFFFFF']
                    });
                    window.confetti({
                        particleCount: 2,
                        angle: 120,
                        spread: 55,
                        origin: { x: 1 },
                        colors: ['#003876', '#FDB913', '#FFFFFF']
                    });

                    if (Date.now() < end) {
                        requestAnimationFrame(frame);
                    }
                };
                frame();
            };

            const isFieldCorrect = (index) => {
                const part = GAME_CONFIG.sentenceStructure[index];
                const answer = userAnswers[index] || "";
                return part.type === 'blank' && normalize(answer) === normalize(part.correct);
            };

            return (
                <div className="min-h-screen bg-slate-50 text-slate-800 font-sans selection:bg-blue-100 flex flex-col">
                    
                    {/* Header */}
                    <header className="bg-[#003876] text-white p-4 shadow-lg sticky top-0 z-10 border-b-4 border-[#FDB913]">
                        <div className="max-w-4xl mx-auto flex justify-between items-center">
                            <div className="flex items-center gap-2">
                                <span className="text-[#FDB913]"><Icons.Zap /></span>
                                <h1 className="text-xl font-bold tracking-tight">Poli Reto</h1>
                            </div>
                            <div className="flex items-center gap-2 bg-blue-800/50 px-3 py-1 rounded-full border border-blue-500/30">
                                <span className="text-[#FDB913]"><Icons.Star size={18} /></span>
                                <span className="font-semibold">{gameState === 'won' ? score : 0} Polipuntos</span>
                            </div>
                        </div>
                    </header>

                    <main className="max-w-3xl mx-auto p-4 md:p-8 flex flex-col items-center gap-6 mt-4 flex-grow w-full">
                        
                        {/* Instrucciones */}
                        <div className="text-center space-y-3">
                            <div className="inline-flex items-center justify-center p-2 bg-blue-100 text-[#003876] rounded-full mb-2">
                                <Icons.MessageSquare size={20} />
                            </div>
                            <h2 className="text-2xl font-bold text-[#003876]">Completa la frase del éxito</h2>
                            <p className="text-slate-600 max-w-lg mx-auto leading-relaxed">
                                Revisa los últimos <span className="font-bold text-[#003876]">comunicados en Teams</span>. 
                                Allí encontrarás las palabras subrayadas que necesitas para completar la oración.
                            </p>
                        </div>

                        {/* Área de la frase */}
                        <div className="bg-white p-6 md:p-10 rounded-2xl shadow-xl w-full border-t-4 border-[#003876]">
                            <div className="flex flex-wrap items-end justify-center gap-x-2 gap-y-6 text-lg md:text-2xl leading-relaxed font-medium">
                                {GAME_CONFIG.sentenceStructure.map((part, index) => {
                                    if (part.type === 'text') {
                                        return <span key={index} className="text-slate-500 py-2">{part.text}</span>;
                                    } else {
                                        const isError = gameState === 'error' && !isFieldCorrect(index);
                                        const isSuccess = (gameState === 'won' || gameState === 'error') && isFieldCorrect(index);
                                        
                                        return (
                                            <div key={index} className="relative group">
                                                <input
                                                    type="text"
                                                    disabled={gameState === 'won'}
                                                    value={userAnswers[index] || ''}
                                                    onChange={(e) => handleInputChange(index, e.target.value)}
                                                    placeholder="?"
                                                    autoComplete="off"
                                                    className={`
                                                        min-w-[120px] w-[140px] text-center border-b-4 bg-slate-50 px-2 py-1 outline-none transition-all duration-300 font-bold rounded-t-md
                                                        ${isSuccess 
                                                            ? 'border-green-500 text-green-700 bg-green-50' 
                                                            : isError
                                                                ? 'border-red-400 text-red-600 bg-red-50 animate-shake'
                                                                : 'border-slate-300 text-[#003876] focus:border-[#003876] focus:bg-blue-50'
                                                        }
                                                    `}
                                                />
                                                {isSuccess && <div className="absolute -top-3 -right-2 text-green-500 bg-white rounded-full shadow-sm"><Icons.Award size={16} /></div>}
                                            </div>
                                        );
                                    }
                                })}
                            </div>
                        </div>

                        {/* Feedback de error - AHORA CON MENSAJE DE ORTOGRAFÍA */}
                        {gameState === 'error' && (
                            <div className="bg-red-50 text-red-600 px-4 py-2 rounded-lg font-medium flex items-center gap-2 animate-bounce border border-red-200 text-center">
                                <span className="font-bold">!</span> 
                                <span>Ups, revisa la ortografía (tildes) y consulta el chat de Teams.</span>
                            </div>
                        )}

                        {/* Botones */}
                        <div className="flex gap-4 mt-2">
                            {gameState !== 'won' && (
                                <button
                                    onClick={checkAnswers}
                                    className="bg-[#FDB913] hover:bg-yellow-400 text-[#003876] font-bold py-3 px-10 rounded-xl shadow-lg transform transition hover:-translate-y-1 active:translate-y-0 text-lg flex items-center gap-2"
                                >
                                    <Icons.Award size={24} />
                                    Verificar
                                </button>
                            )}
                            
                            {attempts > 0 && gameState !== 'won' && (
                                <button 
                                    onClick={resetGame}
                                    className="bg-slate-200 hover:bg-slate-300 text-slate-600 p-3 rounded-xl transition-colors"
                                    title="Borrar todo"
                                >
                                    <Icons.Eraser size={24} />
                                </button>
                            )}
                        </div>

                        {/* Victoria */}
                        {gameState === 'won' && (
                            <div className="text-center space-y-6 w-full animate-pulse-once">
                                <div className="inline-block p-4 bg-green-100 rounded-full text-green-600 mb-2">
                                    <Icons.Trophy className="animate-pulse" />
                                </div>
                                <div>
                                    <h3 className="text-3xl font-bold text-[#003876] mb-2">¡Excelente Trabajo!</h3>
                                    <p className="text-slate-600 mb-6">Estás al día con la información de tu equipo.</p>
                                    
                                    <div className="bg-gradient-to-br from-[#003876] to-blue-800 text-white p-6 rounded-2xl shadow-xl max-w-sm mx-auto transform hover:scale-105 transition-transform border border-[#FDB913]">
                                        <p className="text-[#FDB913] uppercase text-xs font-bold tracking-wider mb-1">Polipuntos Ganados</p>
                                        <div className="text-5xl font-black flex items-center justify-center gap-2">
                                            <span>+{score}</span>
                                            <span className="text-2xl opacity-80 text-[#FDB913]">Pts</span>
                                        </div>
                                        <div className="mt-4 pt-4 border-t border-blue-500/50 flex justify-between text-xs text-blue-200">
                                            <span>Precisión Total</span>
                                            <span>Bono Teams: +10</span>
                                        </div>
                                    </div>
                                </div>

                                <button
                                    onClick={resetGame}
                                    className="text-slate-500 hover:text-[#003876] font-medium flex items-center justify-center gap-2 mx-auto mt-8 transition-colors"
                                >
                                    <Icons.RefreshCcw size={18} />
                                    Reiniciar Reto
                                </button>
                            </div>
                        )}
                    </main>

                    <footer className="w-full p-4 text-center text-slate-400 text-xs mt-auto">
                        <div className="flex justify-center items-center gap-4 opacity-50">
                            <Icons.Heart size={14} /> 
                            <span>Gestión con Empatía y Estrategia</span>
                            <Icons.Target size={14} />
                        </div>
                    </footer>
                </div>
            );
        }

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>

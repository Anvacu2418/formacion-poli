<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Escape PoliPuntos - Misión de Formación</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link href="https://fonts.googleapis.com/css2?family=Fira+Code:wght@400;700&family=Urbanist:wght@400;700;900&display=swap" rel="stylesheet">
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        :root {
            --cyan: #22d3ee;
            --magenta: #d946ef;
            --dark-bg: #09090b;
        }

        body {
            background-color: var(--dark-bg);
            color: #fafafa;
            font-family: 'Urbanist', sans-serif;
            overflow: hidden;
            height: 100vh;
        }

        .terminal-font {
            font-family: 'Fira Code', monospace;
        }

        .glow-cyan {
            box-shadow: 0 0 15px rgba(34, 211, 238, 0.3);
            border: 1px solid var(--cyan);
        }

        .scanline {
            width: 100%;
            height: 2px;
            background: rgba(34, 211, 238, 0.1);
            position: absolute;
            top: 0;
            left: 0;
            z-index: 10;
            pointer-events: none;
            animation: scan 4s linear infinite;
        }

        @keyframes scan {
            0% { top: 0; }
            100% { top: 100%; }
        }

        .hidden-step {
            display: none !important;
        }

        input {
            transition: all 0.3s ease;
            background: rgba(34, 211, 238, 0.05);
            border-radius: 4px;
        }

        input:focus {
            background: rgba(34, 211, 238, 0.15);
            box-shadow: 0 0 10px rgba(34, 211, 238, 0.2);
        }

        .btn-action {
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .btn-action:hover {
            transform: scale(1.05);
            filter: brightness(1.2);
        }

        .progress-bar {
            height: 4px;
            transition: width 0.5s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .input-code {
            border-bottom: 2px solid var(--cyan);
            color: var(--cyan);
            text-align: center;
            font-weight: bold;
            text-transform: uppercase;
            outline: none;
        }

        .hint-box {
            transition: all 0.4s ease;
            max-height: 0;
            opacity: 0;
            overflow: hidden;
        }

        .hint-box.active {
            max-height: 100px;
            opacity: 1;
            margin-top: 1rem;
        }
    </style>
</head>
<body class="flex items-center justify-center p-4">
    <div class="scanline"></div>

    <div id="game-container" class="w-full max-w-3xl bg-zinc-950 rounded-2xl border border-zinc-800 p-8 relative shadow-2xl">
        
        <!-- Header -->
        <div class="flex justify-between items-center mb-10 border-b border-zinc-800 pb-6">
            <div>
                <h1 class="text-2xl font-black tracking-tighter italic">CENTRO DE <span class="text-cyan-400 font-bold">FORMACIÓN</span></h1>
                <p class="text-[10px] terminal-font text-zinc-500 uppercase tracking-widest">Estado: <span id="status-text" class="text-green-500 animate-pulse">Sincronizado</span></p>
            </div>
            <div class="text-right">
                <span id="step-counter" class="text-xs font-bold terminal-font text-zinc-400">FASE: INICIAL</span>
                <div class="w-32 bg-zinc-900 rounded-full mt-2 overflow-hidden h-1">
                    <div id="progress" class="progress-bar bg-cyan-400 w-0"></div>
                </div>
            </div>
        </div>

        <!-- PANTALLA 0: INICIO -->
        <div id="screen-intro" class="text-center py-6">
            <div class="mb-6 inline-flex items-center justify-center w-20 h-20 rounded-full bg-cyan-500/10 text-cyan-400 text-4xl border border-cyan-500/20">
                <i class="fa-solid fa-key"></i>
            </div>
            <h2 class="text-3xl font-black mb-4 uppercase italic">Misión: <span class="text-cyan-400">Escape PoliPuntos</span></h2>
            <p class="text-zinc-400 mb-8 max-w-md mx-auto leading-relaxed">
                Se han detectado fragmentos de comunicados incompletos en el sistema. 
                <br><br>
                <span class="text-white font-bold">Completa la información para desbloquear la misión y tener acceso al final.</span>
            </p>
            <button onclick="changeScreen('screen-intro', 'screen-quiz')" class="px-10 py-4 bg-cyan-500 text-black font-black uppercase tracking-widest rounded-xl btn-action glow-cyan">
                Iniciar Misión
            </button>
        </div>

        <!-- PANTALLA 1: EL QUIZ -->
        <div id="screen-quiz" class="hidden-step">
            
            <div id="level-container" class="min-h-[220px] flex items-center">
                
                <!-- Nivel 1 -->
                <div id="level-1" class="level-content w-full">
                    <h3 class="terminal-font text-cyan-400 mb-4 text-xs font-bold uppercase tracking-widest opacity-60"># Fragmento: Registro_Nuevos</h3>
                    <p class="text-xl md:text-2xl leading-relaxed text-zinc-200">
                        "Para la cohorte C, la inscripción de asignaturas iniciará a mediados del mes de 
                        <input type="text" id="ans1" placeholder="..." class="input-code w-36 mx-2" autocomplete="off"> 
                        de 2026."
                    </p>
                </div>

                <!-- Nivel 2 -->
                <div id="level-2" class="level-content w-full hidden-step">
                    <h3 class="terminal-font text-magenta-400 mb-4 text-xs font-bold uppercase tracking-widest opacity-60"># Fragmento: Psicología_Presencial</h3>
                    <p class="text-xl md:text-2xl leading-relaxed text-zinc-200">
                        "La práctica clínica depende de convenios y solo se asigna en las ciudades de 
                        <input type="text" id="ans2a" placeholder="Ciudad 1" class="input-code w-36 mx-1" autocomplete="off"> 
                        o 
                        <input type="text" id="ans2b" placeholder="Ciudad 2" class="input-code w-36 mx-1" autocomplete="off">."
                    </p>
                </div>

                <!-- Nivel 3 -->
                <div id="level-3" class="level-content w-full hidden-step">
                    <h3 class="terminal-font text-cyan-400 mb-4 text-xs font-bold uppercase tracking-widest opacity-60"># Fragmento: Campaña_Graduación</h3>
                    <p class="text-xl md:text-2xl leading-relaxed text-zinc-200">
                        "Si el estudiante de último semestre ya pagó carga total y le falta una sola materia, escalamos el ticket como: <br>
                        <input type="text" id="ans3" placeholder="ESCRIBE EL CONCEPTO" class="input-code w-full mt-4" autocomplete="off">"
                    </p>
                </div>

                <!-- Nivel 4 -->
                <div id="level-4" class="level-content w-full hidden-step">
                    <h3 class="terminal-font text-yellow-400 mb-4 text-xs font-bold uppercase tracking-widest opacity-60"># Fragmento: Horarios_Cierre</h3>
                    <p class="text-xl md:text-2xl leading-relaxed text-zinc-200">
                        "En las franjas de intermitencia, Programación Académica está realizando la inscripción de materias para estudiantes 
                        <input type="text" id="ans4" placeholder="¿Qué grupo?" class="input-code w-48 mx-2" autocomplete="off">."
                    </p>
                </div>

            </div>

            <!-- Caja de Pista -->
            <div id="hint-display" class="hint-box bg-cyan-900/10 border border-cyan-500/20 rounded-xl p-4 text-center">
                <span class="text-[10px] terminal-font text-cyan-400 uppercase block mb-1">Consultar Comunicado:</span>
                <span id="hint-text" class="text-sm font-bold text-white italic"></span>
            </div>

            <!-- Controles -->
            <div class="mt-8 flex flex-col items-center border-t border-zinc-900 pt-8">
                <div id="feedback" class="h-6 mb-4 terminal-font text-sm font-bold tracking-tight text-center"></div>
                
                <div class="flex gap-4">
                    <button onclick="toggleHint()" class="px-5 py-3 bg-zinc-900 text-zinc-400 rounded-lg font-bold border border-zinc-800 text-[10px] hover:text-cyan-400 hover:border-cyan-900 transition-colors uppercase tracking-widest">
                        <i class="fa-solid fa-lightbulb mr-2"></i> Pista
                    </button>
                    
                    <button id="verify-btn" onclick="checkAnswer()" class="group relative px-12 py-3 bg-zinc-900 text-white rounded-lg font-bold border border-zinc-700 btn-action overflow-hidden">
                        <span class="relative z-10">VALIDAR INFORMACIÓN</span>
                        <div class="absolute inset-0 bg-cyan-500 transform scale-x-0 group-hover:scale-x-100 transition-transform origin-left duration-300 opacity-10"></div>
                    </button>
                </div>

                <p class="mt-4 text-[10px] text-zinc-600 terminal-font uppercase">Presiona ENTER para continuar</p>
            </div>
        </div>

        <!-- PANTALLA FINAL -->
        <div id="screen-success" class="hidden-step text-center py-6">
            <div class="mb-6 inline-flex items-center justify-center w-20 h-20 rounded-full bg-green-500/10 text-green-400 text-4xl border border-green-500/20">
                <i class="fa-solid fa-trophy"></i>
            </div>
            <h2 class="text-4xl font-black mb-2 uppercase italic">¡MISIÓN <span class="text-green-400">COMPLETADA</span>!</h2>
            
            <div class="bg-zinc-900/50 border border-zinc-800 rounded-xl p-6 mb-8 max-w-sm mx-auto">
                <p class="text-zinc-400 text-sm uppercase tracking-widest mb-2 terminal-font">Recompensa Obtenida:</p>
                <p class="text-5xl font-black text-white mb-2 tracking-tighter">50 <span class="text-cyan-400">PUNTOS</span></p>
                <div class="h-px bg-zinc-800 w-full my-4"></div>
                <p class="text-zinc-300 text-sm leading-relaxed">
                    Has restaurado la base de datos de los comunicados. 
                    <br><br>
                    <span class="text-magenta-400 font-bold">¡IMPORTANTE!</span><br>
                    Toma una captura de esta pantalla y compártela por <span class="text-white font-bold">Teams</span> para validar tus PoliPuntos.
                </p>
            </div>

            <button onclick="location.reload()" class="text-zinc-600 hover:text-white terminal-font text-[10px] uppercase tracking-widest transition-colors underline decoration-zinc-900 underline-offset-4">
                Reiniciar Misión
            </button>
        </div>

    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/js/all.min.js"></script>

    <script>
        let currentLevel = 1;
        const totalLevels = 4;
        let hintVisible = false;

        const hints = {
            1: "INSCRIPCIÓN ASIGNATURAS ESTUDIANTES NUEVOS",
            2: "Consentimiento Práctica Clínica",
            3: "Asignatura Adicional - Último Semestre",
            4: "INSCRIPCIÓN DE ASIGNATURAS 2026-1 (NotiBoom)"
        };

        function normalize(text) {
            return text.toUpperCase().trim()
                .normalize("NFD").replace(/[\u0300-\u036f]/g, "");
        }

        function changeScreen(hide, show) {
            document.getElementById(hide).classList.add('hidden-step');
            document.getElementById(show).classList.remove('hidden-step');
            
            if(show === 'screen-quiz') {
                updateUI();
                focusInput();
            }
        }

        function toggleHint() {
            const hintBox = document.getElementById('hint-display');
            const hintText = document.getElementById('hint-text');
            
            if (!hintVisible) {
                hintText.innerText = hints[currentLevel];
                hintBox.classList.add('active');
                hintVisible = true;
            } else {
                hintBox.classList.remove('active');
                hintVisible = false;
            }
        }

        function focusInput() {
            const currentInput = document.querySelector(`#level-${currentLevel} input`);
            if (currentInput) currentInput.focus();
        }

        function updateUI() {
            document.getElementById('step-counter').innerText = `FRAGMENTO: 0${currentLevel} / 0${totalLevels}`;
            document.getElementById('progress').style.width = `${(currentLevel / totalLevels) * 100}%`;
            document.getElementById('status-text').innerText = `RESTURANDO DATOS... NIVEL ${currentLevel}`;
            
            document.getElementById('hint-display').classList.remove('active');
            hintVisible = false;
        }

        function showFeedback(msg, isError) {
            const fb = document.getElementById('feedback');
            fb.innerText = msg;
            fb.className = isError ? "text-red-500 animate-pulse h-6 mb-4 terminal-font text-sm font-bold" : "text-green-400 h-6 mb-4 terminal-font text-sm font-bold";
            
            if(isError) {
                const container = document.getElementById('game-container');
                container.classList.add('border-red-900');
                setTimeout(() => container.classList.remove('border-red-900'), 500);
            }
        }

        function checkAnswer() {
            let isCorrect = false;

            if (currentLevel === 1) {
                const val = normalize(document.getElementById('ans1').value);
                if (val === "MARZO") isCorrect = true;
            } 
            else if (currentLevel === 2) {
                const valA = normalize(document.getElementById('ans2a').value);
                const valB = normalize(document.getElementById('ans2b').value);
                const cities = ["BOGOTA", "MEDELLIN"];
                if ((cities.includes(valA) && cities.includes(valB)) && valA !== valB) isCorrect = true;
            } 
            else if (currentLevel === 3) {
                const val = normalize(document.getElementById('ans3').value);
                if (val === "ULTIMA MATERIA") isCorrect = true;
            } 
            else if (currentLevel === 4) {
                const val = normalize(document.getElementById('ans4').value);
                if (val === "PRIMIPAROS" || val === "ESTUDIANTES PRIMIPAROS") isCorrect = true;
            }

            if (isCorrect) {
                showFeedback("✓ DATOS RESTAURADOS CORRECTAMENTE.", false);
                setTimeout(nextLevel, 1200);
            } else {
                showFeedback("✗ ERROR: LA INFORMACIÓN NO COINCIDE", true);
            }
        }

        function nextLevel() {
            if (currentLevel < totalLevels) {
                document.getElementById(`level-${currentLevel}`).classList.add('hidden-step');
                currentLevel++;
                document.getElementById(`level-${currentLevel}`).classList.remove('hidden-step');
                document.getElementById('feedback').innerText = "";
                updateUI();
                focusInput();
            } else {
                finishGame();
            }
        }

        function finishGame() {
            document.getElementById('screen-quiz').classList.add('hidden-step');
            document.getElementById('screen-success').classList.remove('hidden-step');
            document.getElementById('status-text').innerText = "MISIÓN COMPLETADA CON ÉXITO";
            document.getElementById('status-text').className = "text-green-400 font-bold";
        }

        window.addEventListener('keydown', (e) => {
            if (e.key === 'Enter') {
                if (!document.getElementById('screen-quiz').classList.contains('hidden-step')) {
                    checkAnswer();
                } else if (!document.getElementById('screen-intro').classList.contains('hidden-step')) {
                    changeScreen('screen-intro', 'screen-quiz');
                }
            }
        });
    </script>
</body>
</html>
